import{j as g,e as V,y as B,i as f,f as a,g as s,t as u,q as S,p as h,v as w,x,O as j,u as L,o as c}from"./vendor-CLLCb1yY.js";import{_ as R,u as A,m as l}from"./index-Bwo_eupb.js";const D={class:"auth-container"},q={class:"header-section"},H={class:"page-title"},U={class:"page-subtitle"},$={class:"form-section"},N={key:0,class:"form-group"},T={class:"input-wrapper"},Z={class:"form-group"},E={class:"input-wrapper"},F={class:"form-group"},O={class:"input-wrapper"},P=["type"],z={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J={key:1,class:"form-options"},K=["disabled"],Q={class:"switch-form"},W={__name:"Auth",setup(X){const i=L(),C=V(),v=A(),r=g(()=>C.path==="/login"),o=B({username:"",account:"",password:""}),d=f(!1),p=f(!1),m=g(()=>{const n=o.account.trim();return n?/^1[3-9]\d{9}$/.test(n)?"phone":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?"email":null:null}),b=()=>o.account.trim()?m.value?!0:(l.error("请输入有效的手机号或邮箱"),!1):(l.error("请输入手机号或邮箱"),!1),y=()=>{k(),r.value?i.push("/register"):i.push("/login")},_=async()=>{var n,t;if(b()){p.value=!0;try{if(r.value){const e=await v.login({account:o.account,password:o.password});(n=e==null?void 0:e.session)!=null&&n.access_token?(i.push("/"),l.success("登录成功")):l.error("登录失败，请检查账号和密码是否正确",6e3)}else{const e=await v.register({username:o.username,account:o.account,password:o.password});(t=e==null?void 0:e.user)!=null&&t.id?(i.push("/login"),m.value==="phone"?l.success("手机注册成功！"):l.success("注册成功，你会收到一封邮件，请先点击邮件中的链接进行验证才能登录！",6e3)):l.error("注册失败，请重试"),k()}}catch(e){console.error("认证失败:",e),l.error(e.message||"登录注册操作失败，请重试")}finally{p.value=!1}}},k=()=>{o.username="",o.account="",o.password=""},M=()=>{i.push("/welcome")};return(n,t)=>(c(),a("div",D,[s("button",{class:"back-btn",onClick:M},[...t[4]||(t[4]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M19 12H5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M12 19L5 12L12 5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),s("div",q,[s("h1",H,u(r.value?"登录":"注册"),1),s("p",U,u(r.value?"欢迎回来！":"创建您的账户"),1)]),s("div",$,[s("form",{onSubmit:S(_,["prevent"])},[r.value?h("",!0):(c(),a("div",N,[t[6]||(t[6]=s("label",{class:"form-label"},"用户名",-1)),s("div",T,[t[5]||(t[5]=s("span",{class:"input-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),s("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2"})])],-1)),w(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e),type:"text",placeholder:"请输入用户名",required:""},null,512),[[x,o.username]])])])),s("div",Z,[t[8]||(t[8]=s("label",{class:"form-label"},"账号",-1)),s("div",E,[t[7]||(t[7]=s("span",{class:"input-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z",stroke:"currentColor","stroke-width":"2"}),s("path",{d:"M22 6L12 13L2 6",stroke:"currentColor","stroke-width":"2"})])],-1)),w(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.account=e),type:"text",placeholder:"请输入手机号/邮箱",required:""},null,512),[[x,o.account]])])]),s("div",F,[t[12]||(t[12]=s("label",{class:"form-label"},"密码",-1)),s("div",O,[t[11]||(t[11]=s("span",{class:"input-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2"}),s("path",{d:"M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})])],-1)),w(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.password=e),type:d.value?"text":"password",placeholder:"请输入密码",required:""},null,8,P),[[j,o.password]]),s("button",{type:"button",class:"toggle-password",onClick:t[3]||(t[3]=e=>d.value=!d.value)},[d.value?(c(),a("svg",G,[...t[10]||(t[10]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(c(),a("svg",z,[...t[9]||(t[9]=[s("path",{d:"M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2"},null,-1)])]))])])]),r.value?(c(),a("div",J,[...t[13]||(t[13]=[s("a",{href:"#",class:"forgot-link"},"忘记密码？",-1)])])):h("",!0),s("button",{type:"submit",class:"submit-btn",disabled:p.value},u(p.value?"处理中...":r.value?"登录":"注册"),9,K),s("div",Q,[s("span",null,u(r.value?"还没有账号？":"已有账号？"),1),s("button",{type:"button",class:"link-btn",onClick:y},u(r.value?"立即注册":"立即登录"),1)])],32)]),t[14]||(t[14]=s("div",{class:"bottom-decoration"},[s("div",{class:"decoration-circle"})],-1))]))}},ss=R(W,[["__scopeId","data-v-944976bf"]]);export{ss as default};
