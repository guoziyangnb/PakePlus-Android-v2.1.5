import{a as L,_ as M,b as V,u as T,g as E,m as F}from"./index-BsLNy1A6.js";import{_ as q}from"./Header-Bt5F6yjk.js";import{f as w,T as N}from"./TransactionItem-B9TJhCCc.js";import{f as d,o as r,g as e,t as k,h as f,i as Q,w as H,J as B,P as U,Q as W,F as D,r as I,j as z,l as b,m as P,K as j,p as G,I as J,k as K}from"./vendor-CLLCb1yY.js";import{O as X}from"./Overlay-B0sPJSDj.js";const Y={class:"balance-card"},Z={class:"balance-amount"},ee={class:"balance-stats"},te={class:"balance-stat"},se={class:"balance-stat-info"},ae={class:"balance-stat-value"},oe={class:"balance-stat"},ne={class:"balance-stat-info"},ce={class:"balance-stat-value"},ie={__name:"BalanceCard",setup(S){const t=L();return(h,s)=>(r(),d("div",Y,[s[4]||(s[4]=e("div",{class:"balance-label"},"钱包余额",-1)),e("div",Z,k(f(w)(f(t).totalBalance,!0)),1),e("div",ee,[e("div",te,[s[1]||(s[1]=e("div",{class:"balance-stat-icon"},[e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})])],-1)),e("div",se,[s[0]||(s[0]=e("span",{class:"balance-stat-label"},"总收入",-1)),e("span",ae,k(f(w)(f(t).totalIncome,!1)),1)])]),e("div",oe,[s[3]||(s[3]=e("div",{class:"balance-stat-icon"},[e("svg",{viewBox:"0 0 24 24"},[e("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})])],-1)),e("div",ne,[s[2]||(s[2]=e("span",{class:"balance-stat-label"},"总支出",-1)),e("span",ce,k(f(w)(f(t).totalExpense,!1)),1)])])])]))}},re={class:"chart-card glass-card"},le={__name:"LineChart",setup(S){const t=Q(null),h=V(),s=L();let a=null,n=null;function g(){const i=new Date,o=[],x=new Date(i);x.setDate(i.getDate()-(i.getDay()+6)%7),x.setHours(0,0,0,0);const A=["周一","周二","周三","周四","周五","周六","周日"];for(let l=0;l<7;l++){const y=new Date(x);y.setDate(x.getDate()+l),y.setHours(0,0,0,0);const C=new Date(y);C.setDate(y.getDate()+1);const $=s.records.filter(m=>{const v=new Date(m.date);return v>=y&&v<C}),R=$.filter(m=>m.type==="expense").reduce((m,v)=>m+Math.abs(v.amount),0),O=$.filter(m=>m.type==="income").reduce((m,v)=>m+v.amount,0);o.push({date:A[l],expense:R,income:O})}return{dates:o.map(l=>l.date),expenseData:o.map(l=>l.expense),incomeData:o.map(l=>l.income)}}function u(){const i=g(),o=h.isDark;return{grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},legend:{top:0,left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:i.dates,boundaryGap:!1,axisLine:{lineStyle:{color:o?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"}},axisLabel:{color:o?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",fontSize:11}},yAxis:[{type:"value",name:"支出/元",position:"left",axisLine:{show:!1},axisLabel:{color:o?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",fontSize:11},nameTextStyle:{color:o?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",fontSize:11},splitLine:{lineStyle:{color:o?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",type:"dashed"}}},{type:"value",name:"收入/元",position:"right",axisLine:{show:!1},axisLabel:{color:o?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",fontSize:11},nameTextStyle:{color:o?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",fontSize:11},splitLine:{show:!1}}],series:[{name:"支出",type:"line",yAxisIndex:0,smooth:!0,symbol:"circle",symbolSize:6,data:i.expenseData,lineStyle:{width:3,color:"#FF8A5B"},itemStyle:{color:"#FF8A5B",borderColor:"#fff",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(255, 138, 91, 0.3)"},{offset:1,color:"rgba(255, 138, 91, 0)"}]}}},{name:"收入",type:"line",yAxisIndex:1,smooth:!0,symbol:"circle",symbolSize:6,data:i.incomeData,lineStyle:{width:3,color:"#52C41A"},itemStyle:{color:"#52C41A",borderColor:"#fff",borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(82, 196, 26, 0.3)"},{offset:1,color:"rgba(82, 196, 26, 0)"}]}}}],animationDuration:1500,animationEasing:"cubicOut"}}function p(){t.value&&(a=W(t.value),a.setOption(u()))}function c(){a&&(a.clear(),a.setOption(u()))}H(()=>h.theme,()=>{c()}),H(()=>s.records,()=>{c()},{deep:!0}),B(()=>{p(),n=new ResizeObserver(()=>{a&&a.resize()}),t.value&&n.observe(t.value),window.addEventListener("resize",_)});function _(){a&&a.resize()}return U(()=>{a&&a.dispose(),n&&t.value&&(n.unobserve(t.value),n.disconnect()),window.removeEventListener("resize",_)}),(i,o)=>(r(),d("div",re,[o[0]||(o[0]=e("div",{class:"chart-header"},[e("div",{class:"chart-title"},"收支趋势"),e("div",{class:"chart-period"},"本周")],-1)),e("div",{ref_key:"chartRef",ref:t,class:"chart-container"},null,512)]))}},de=M(le,[["__scopeId","data-v-5bd657ac"]]),ue={class:"quick-actions"},pe=["onClick"],me={class:"quick-action-icon"},he=["innerHTML"],_e={class:"quick-action-label"},ve={__name:"QuickActions",emits:["click"],setup(S,{emit:t}){const h=t,s=[{name:"food",label:"餐饮",type:"expense",category:"餐饮",icon:'<path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/>'},{name:"transport",label:"交通",type:"expense",category:"交通",icon:'<path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>'},{name:"shopping",label:"购物",type:"expense",category:"购物",icon:'<path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>'},{name:"income",label:"收入",type:"income",category:"工资",icon:'<path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>'}];function a(n){h("click",n)}return(n,g)=>(r(),d("div",ue,[(r(),d(D,null,I(s,u=>e("div",{key:u.name,class:"quick-action-item",onClick:p=>a(u)},[e("div",me,[(r(),d("svg",{viewBox:"0 0 24 24",innerHTML:u.icon},null,8,he))]),e("div",_e,k(u.label),1)],8,pe)),64))]))}},fe={class:"page fade-in-up"},be={class:"container"},ye={class:"balance-section"},ge={class:"chart-section"},xe={class:"quick-actions-section"},ke={class:"transactions-section"},Se={class:"section-header"},we={key:0},ze={key:0,class:"records-limit-hint"},De={key:1,class:"empty-state"},Le={__name:"Home",setup(S){const t=L(),h=T(),s=V(),a=z(()=>t.loading),n=z(()=>t.records.slice(0,30)),g=z(()=>t.records.length>30);B(async()=>{const p=E("backupSettings",{}),c=p.cloudBackup===void 0?!0:p.cloudBackup;if(h.userId&&c)try{await t.fetchRecentRecords(h.userId,30)}catch(_){console.error("加载记录失败:",_),F.error("加载记录失败",_.message)}});function u(p){s.openModal(p.type,p.category)}return(p,c)=>{const _=j("router-link");return r(),d(D,null,[e("div",fe,[b(q,{title:"我的钱包"}),e("div",be,[e("div",ye,[b(ie)]),e("div",ge,[b(de)]),e("div",xe,[b(ve,{onClick:u})]),e("div",ke,[e("div",Se,[c[1]||(c[1]=e("div",{class:"section-title"},"最近交易",-1)),b(_,{to:"/calendar",class:"view-all-btn"},{default:P(()=>[...c[0]||(c[0]=[J("查看全部",-1)])]),_:1})]),n.value.length>0?(r(),d("div",we,[(r(!0),d(D,null,I(n.value,i=>(r(),K(N,{key:i.id,record:i},null,8,["record"]))),128)),g.value?(r(),d("div",ze,"最近记录最多显示30条，其余请点击查看更多查看")):G("",!0)])):(r(),d("div",De,[...c[2]||(c[2]=[e("p",null,"暂无记录，点击下方按钮添加",-1)])]))])])]),b(X,{show:a.value},null,8,["show"])],64)}}},Be=M(Le,[["__scopeId","data-v-a965eced"]]);export{Be as default};
